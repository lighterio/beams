!function(n){var t=function(){},e=t,i=t,r=function(){var t=n.XMLHttpRequest,e=n.ActiveXObject;return t?new t:e?new e("Microsoft.XMLHTTP"):!1},o=function(n,t,u,c){p(t)&&(c=u,u=t,t=0);var a=r();return a&&(c=c||i,u=u||e,a.onreadystatechange=function(){if(4==a.readyState){d('[Jymin] Received response from "'+n+'". ('+o._WAITING+" in progress)."),--o._WAITING;var t=a.status,r=200==t,f=r?u||e:c||i,s=parse(a.responseText);s._STATUS=t,s._REQUEST=a,f(s)}},a.open(t?"POST":"GET",n,!0),a.setRequestHeader("x-requested-with","XMLHttpRequest"),t&&a.setRequestHeader("content-type","application/x-www-form-urlencoded"),a._URL=n,t&&(a._BODY=t),a._TIME=f(),o._WAITING=(o._WAITING||0)+1,d('[Jymin] Sending request to "'+n+'". ('+o._WAITING+" in progress)."),a.send(t||null)),!0},u=function(n,t){if(n)for(var e=0,i=c(n);i>e;e++){var r=t(n[e],e,n);if(r===!1)break}},c=function(n){return _(n)||l(n)?n.length:0},a=function(n,t){return v(n)&&n.push(t),t},f=function(n){return n=n||new Date,n.getTime()},s=function(){m("error",arguments)},d=function(){m("log",arguments)},m=function(t,e){var i=n.console;i&&i[t]&&i[t].apply(i,e)},T=function(n){return encodeURIComponent(n)},g=function(n,t){return typeof n==t},l=function(n){return g(n,"string")},p=function(n){return g(n,"function")},_=function(n,t){return n instanceof(t||Object)},v=function(n){return _(n,Array)},I=1e3,N=function(){function e(){d('[Beams] Polling for messages at "'+g+'".'),o(g,i,r)}function i(n){u(n,function(n){var t=n[0],e=n[1];c(t,e)}),addTimeout(N,e,0)}function r(){addTimeout(N,e,I),s('[Beams] Failed to connect to "'+g+'".')}function c(n,t){d('[Beams] Received "'+n+'": '+stringify(t)+"."),u(_[n],function(e){p(e)?e.call(N,t):s('[Beams] Handler for "'+n+'" is not a function: '+stringify(e)+".")})}function f(n){N.id=n.id,g=m+"?id="+N.id,d('[Beams] Set endpoint URL to "'+g+'".'),u(l,function(n){n()}),l=[]}if(n.Beams=N,N._ON)return N;d("[Beams] Initializing client.");var m="/beam",g=m,l=[],_={},v=!1;onReady(function(){v&&(_={connect:f}),v=!0});var y=0;return N._ON=N.on=function(n,t){d('[Beams] Listening for "'+n+'".');var e=_[n];return e||(e=_[n]=[]),a(e,t),N},N._HANDLE=N.handle=function(n,t){return d('[Beams] Listening for "'+n+'" with a singular handler.'),_[n]=[t],N},N._CONNECT=N.connect=function(n){return N._ON("connect",n),N},N._EMIT=N.emit=function(n,e){function i(){o(g+"&m="+T(n)+"&n="+y,"d="+T(e),t,function(){setTimeout(i,I)})}return e=stringify(e||{},1),d('[Beams] Emitting "'+n+'": '+e+"."),y++,N.id?i():l.push(i),N},N._CONNECT(f),e(),N};n.Beams=N}(window);