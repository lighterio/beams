!function(n){var e=function(){},t=e,i=e,r=function(){var e=n.XMLHttpRequest,t=n.ActiveXObject;return e?new e:t?new t("Microsoft.XMLHTTP"):!1},o=function(n,e,u,c){p(e)&&(c=u,u=e,e=0);var a=r();return a&&(c=c||i,u=u||t,a.onreadystatechange=function(){if(4==a.readyState){d('[Jymin] Received response from "'+n+'". ('+o._WAITING+" in progress)."),--o._WAITING;var e=a.status,r=200==e,f=r?u||t:c||i,s=parse(a.responseText);s._STATUS=e,s._REQUEST=a,f(s)}},a.open(e?"POST":"GET",n,!0),a.setRequestHeader("x-requested-with","XMLHttpRequest"),e&&a.setRequestHeader("content-type","application/x-www-form-urlencoded"),a._URL=n,e&&(a._BODY=e),a._TIME=f(),o._WAITING=(o._WAITING||0)+1,d('[Jymin] Sending request to "'+n+'". ('+o._WAITING+" in progress)."),a.send(e||null)),!0},u=function(n,e){if(n)for(var t=0,i=c(n);i>t;t++){var r=e(n[t],t,n);if(r===!1)break}},c=function(n){return _(n)||l(n)?n.length:0},a=function(n,e){return v(n)&&n.push(e),e},f=function(n){return n=n||new Date,n.getTime()},s=function(){m("error",arguments)},d=function(){m("log",arguments)},m=function(e,t){var i=n.console;i&&i[e]&&i[e].apply(i,t)},T=function(n){return encodeURIComponent(n)},g=function(n,e){return typeof n==e},l=function(n){return g(n,"string")},p=function(n){return g(n,"function")},_=function(n,e){return n instanceof(e||Object)},v=function(n){return _(n,Array)},I=1e3,N=function(){function t(){d('[Beams] Polling for messages at "'+g+'".'),o(g,i,r)}function i(n){u(n,function(n){var e=n[0],t=n[1];c(e,t)}),addTimeout(N,t,0)}function r(){addTimeout(N,t,I),s('[Beams] Failed to connect to "'+g+'".')}function c(n,e){d('[Beams] Received "'+n+'": '+stringify(e)+"."),u(p[n],function(n){n.call(N,e)})}function f(n){N.id=n.id,g=m+"?id="+N.id,d('[Beams] Set endpoint URL to "'+g+'".'),u(l,function(n){n()}),l=[]}if(n.Beams=N,N._ON)return N;d("[Beams] Initializing client.");var m="/beam",g=m,l=[],p={},_=!1;onReady(function(){_&&(p={connect:f}),_=!0});var v=0;return N._ON=N.on=function(n,e){d('[Beams] Listening for "'+n+'".');var t=p[n];return t||(t=p[n]=[]),a(t,e),N},N._HANDLE=N.handle=function(n,e){return d('[Beams] Listening for "'+n+'" with a singular handler.'),p[n]=[e],N},N._CONNECT=N.connect=function(n){return N._ON("connect",n),N},N._EMIT=N.emit=function(n,t){function i(){o(g+"&m="+T(n)+"&n="+v,"d="+T(t),e,function(){setTimeout(i,I)})}return t=stringify(t||{},1),d('[Beams] Emitting "'+n+'": '+t+"."),v++,N.id?i():l.push(i),N},N._CONNECT(f),t(),N};n.Beams=N}(window);